<%- include("../partials/admin/header", { title: "Users" , adminName: typeof adminName !=="undefined" ? adminName
    : "Admin" }) %>

    <div class="dashboard-content" style="padding: 20px 17px;">

        <div class="content-header"
        style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
    
        <h1 style="font-size:28px; font-weight:600; color:#333;">Users</h1>
    
        <div style="display:flex; align-items:center; gap:10px;">
    
        
            <form action="/admin/users" method="GET" style="display:flex; gap:8px; align-items:center;">
                <div style="position:relative;">
                    <input 
                        type="text" 
                        id="searchInput"
                        name="search" 
                        placeholder="Search Users..." 
                        value="<%= query.search || '' %>"
                        style="padding:10px 30px 10px 10px; border:1px solid #ccc; border-radius:5px;"
                    >
            
                    <span 
                    id="clearBtn"
                    onclick="clearSearch()"
                    style="
                        position:absolute;
                        right:8px;
                        top:50%;
                        transform:translateY(-50%);
                        cursor:pointer;
                        font-size:16px;
                        color:#888;
                        display: <%= query.search ? 'block' : 'none' %>;
                    "
                >Ã—</span>
        
                </div>
            
                <button type="submit" 
                    style="padding:10px 14px; border:none; background:#1e90ff; color:white; border-radius:5px;">
                    Search
                </button>
            </form>
            
            
    
        
        </div>
    </div>

        <div class="table-container"
            style="background:white; border:1px solid #e0e0e0; border-radius:8px; overflow:hidden;">
            <table style="width:100%; border-collapse:collapse;">
                <thead>
                    <tr>
                        <th style="background:#e8e8e8; padding:15px; text-align:left;">ID</th>
                        <th style="background:#e8e8e8; padding:15px; text-align:left;">Name</th>
                        <th style="background:#e8e8e8; padding:15px; text-align:left;">Email</th>
                        <th style="background:#e8e8e8; padding:15px; text-align:left;">User Status</th>
                    </tr>
                </thead>

                <tbody>
                    <% users.forEach((user, index)=> { %>
                        <tr style="border-bottom:1px solid #e8e8e8;">
                            <td style="padding:15px;">
                                <%= index + 1 %>
                            </td>
                            <td style="padding:15px;">
                                <%= user.fullname %>
                            </td>
                            <td style="padding:15px;">
                                <%= user.email %>
                            </td>
                            <td style="padding:15px;">


                                <% if (user.isBlocked) { %>

                                    <button class="unblock-btn" onclick="unblockUser('<%= user._id %>','<%= currentPage %>')">
                                        Unblock
                                    </button>

                                    <% } else { %>

                                        <button class="block-btn" onclick="blockUser('<%= user._id %>','<%= currentPage %>')">
                                            Block
                                        </button>

                                        <% } %>


                            </td>
                        </tr>
                        <% }) %>
                </tbody>

            </table>
<div class="container mt-3">
    <nav aria-label="Page Navigation">
        <ul class="pagination">

            <li class="page-item <%= currentPage === 1 ? 'disabled' : '' %>">
                <a class="page-link" href="?page=1&search=<%= search %>&limit=<%= limit %>">First</a>
            </li>

            <% for (let i = 1; i <= totalPages; i++) { %>
                <li class="page-item <%= i === currentPage ? 'active' : '' %>">
                    <a class="page-link" href="?page=<%= i %>&search=<%= search %>&limit=<%= limit %>">
                        <%= i %>
                    </a>
                </li>
            <% } %>

            <li class="page-item <%= currentPage === totalPages ? 'disabled' : '' %>">
                <a class="page-link" href="?page=<%= totalPages %>&search=<%= search %>&limit=<%= limit %>">Last</a>
            </li>

        </ul>
    </nav>
</div>


        </div>

    </div>

    <script>
        function clearSearch() {
            const input = document.getElementById('searchInput');
            input.value = "";         
            input.form.submit();       
        }
        </script>
    <%- include("../partials/admin/footer") %>